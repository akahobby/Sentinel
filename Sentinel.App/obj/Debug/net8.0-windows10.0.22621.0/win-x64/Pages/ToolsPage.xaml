<Page
    x:Class="Sentinel.App.Pages.ToolsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <ScrollViewer>
        <StackPanel Padding="28,24" Spacing="20">
            <StackPanel Spacing="6">
                <TextBlock Text="Tools" Style="{StaticResource TitleTextStyle}" />
                <TextBlock Text="System maintenance and diagnostic utilities. Administrator privileges are required for full functionality." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" />
            </StackPanel>

            <!-- Temp cleanup (tempdel) -->
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="8" Padding="14,12" BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xE74D;" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{StaticResource SubtleTextBrush}" />
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="Temporary File Cleanup" FontWeight="SemiBold" FontSize="14" />
                        <TextBlock Text="Removes temporary files from user and system temp directories and the Prefetch cache. Administrator rights required for system paths." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Margin="0,2,0,0" />
                    </StackPanel>
                    <Button Grid.Column="2" Content="Run" Command="{Binding TempCleanupCommand}" VerticalAlignment="Center" />
                </Grid>
            </Border>

            <!-- USB power saving -->
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="8" Padding="14,12" BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xE8B8;" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{StaticResource SubtleTextBrush}" />
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="USB Power Management" FontWeight="SemiBold" FontSize="14" />
                        <TextBlock Text="Disables USB selective suspend via WMI to prevent device sleep and unexpected disconnects. Administrator rights required." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Margin="0,2,0,0" />
                    </StackPanel>
                    <Button Grid.Column="2" Content="Run" Command="{Binding UsbPowerDisableCommand}" VerticalAlignment="Center" />
                </Grid>
            </Border>

            <!-- TPM attestation fix -->
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="8" Padding="14,12" BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xE72E;" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{StaticResource SubtleTextBrush}" />
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="TPM Attestation Repair" FontWeight="SemiBold" FontSize="14" />
                        <TextBlock Text="Restores Windows TPM provisioning tasks and attestation state for applications that require hardware verification. Administrator rights required." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Margin="0,2,0,0" />
                    </StackPanel>
                    <Button Grid.Column="2" Content="Run" Command="{Binding TpmFixCommand}" VerticalAlignment="Center" />
                </Grid>
            </Border>

            <!-- ZeroTrace -->
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="8" Padding="14,12" BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xE946;" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{StaticResource SubtleTextBrush}" />
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="ZeroTrace" FontWeight="SemiBold" FontSize="14" />
                        <TextBlock Text="Uninstalls applications and removes all leftover files, registry entries, services, and scheduled tasks (like Revo Uninstaller). Administrator rights required." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Margin="0,2,0,0" />
                    </StackPanel>
                    <Button Grid.Column="2" Content="Run ZeroTrace" Command="{Binding RunZeroTraceCommand}" VerticalAlignment="Center" />
                </Grid>
            </Border>

            <!-- Win11Reclaim -->
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="8" Padding="14,12" BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xE7F3;" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{StaticResource SubtleTextBrush}" />
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="Win11 Reclaim" FontWeight="SemiBold" FontSize="14" />
                        <TextBlock Text="Launches the Win11Reclaim toolkit to debloat and reclaim your Windows install (external elevated PowerShell UI)." Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Margin="0,2,0,0" />
                    </StackPanel>
                    <Button Grid.Column="2" Content="Launch" Command="{Binding RunWin11ReclaimCommand}" VerticalAlignment="Center" />
                </Grid>
            </Border>

            <!-- Status -->
            <Border Background="#2A2A2A" CornerRadius="8" Padding="14,12" Visibility="{Binding StatusText, Converter={StaticResource StringToVisibilityConverter}}">
                <StackPanel Spacing="6">
                    <TextBlock Text="Result" Style="{StaticResource CaptionTextStyle}" Foreground="{StaticResource SubtleTextBrush}" />
                    <TextBlock Text="{Binding StatusText}" TextWrapping="Wrap" FontSize="13" />
                </StackPanel>
            </Border>

            <ProgressRing IsActive="{Binding IsBusy}" Width="32" Height="32" HorizontalAlignment="Left" />
        </StackPanel>
    </ScrollViewer>
</Page>

